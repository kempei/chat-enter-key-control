# Popup UI 使用方法

## 概要

Chat Enter Key Control拡張機能のポップアップUIは、URLパターンの管理と現在のページの状態確認を行うためのインターフェースです。

## 機能

### 1. 現在のページの状態表示

ポップアップを開くと、最上部に現在のページの状態が表示されます：

- **有効**: 現在のページが登録されたパターンにマッチしている場合、緑色の●と「有効」が表示されます
- **無効**: マッチしていない場合、グレーの●と「無効」が表示されます
- **現在のURL**: 現在のページのURLが表示されます

### 2. 簡易トグル機能

現在のページのドメインが登録されていない場合、「このドメインを有効化」ボタンが表示されます。このボタンをクリックすると、現在のドメインのパターン（例: `*://example.com/*`）が自動的に追加されます。

### 3. URLパターンの追加

「URLパターンを追加」セクションで新しいパターンを追加できます：

1. テキストフィールドにパターンを入力
2. 「追加」ボタンをクリック、またはEnterキーを押す

#### パターンの書き方

- `*://example.com/*` - example.comのすべてのページ
- `*://*.example.com/*` - すべてのサブドメイン
- `https://chat.example.com/*` - HTTPSのみ
- `<all_urls>` - すべてのURL

### 4. URLパターンの管理

「登録済みパターン」セクションで既存のパターンを管理できます：

- **トグルスイッチ**: クリックしてパターンを有効/無効に切り替え
- **削除ボタン（🗑️）**: パターンを削除

### 5. 設定のインポート/エクスポート

- **エクスポート**: 現在の設定をJSONファイルとしてダウンロード
- **インポート**: JSONファイルから設定を読み込み

## 実装詳細

### ファイル構成

- `popup.html`: ポップアップのHTML構造
- `popup.css`: ポップアップのスタイル
- `popup.js`: ポップアップのロジック

### Background Scriptとの通信

popup.jsは以下のメッセージタイプを使用してbackground.jsと通信します：

- `GET_PATTERNS`: すべてのパターンを取得
- `ADD_PATTERN`: 新しいパターンを追加
- `REMOVE_PATTERN`: パターンを削除
- `TOGGLE_PATTERN`: パターンをトグル
- `EXPORT_SETTINGS`: 設定をエクスポート
- `IMPORT_SETTINGS`: 設定をインポート

### 要件との対応

- **要件 3.1**: ポップアップを開くとURLパターンのリストが表示される ✅
- **要件 3.2**: 新しいURLパターンを追加できる ✅
- **要件 3.3**: URLパターンを削除できる ✅
- **要件 3.4**: URLパターンをトグル（有効/無効）できる ✅
- **要件 8.3**: ポップアップに現在のページの状態が表示される ✅
- **要件 8.4**: 現在のページがパターンにマッチするかどうかが表示される ✅
- **要件 8.5**: 現在のドメインの簡易トグル機能がある ✅

## 動作確認方法

1. Chrome拡張機能として読み込む（`chrome://extensions/`）
2. 任意のWebページを開く
3. 拡張機能アイコンをクリックしてポップアップを開く
4. URLパターンを追加・削除・トグルして動作を確認
5. 設定のエクスポート/インポートを確認
